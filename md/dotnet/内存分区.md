## 分区策略

-   大小
-   生存期
-   可变形
-   类型
-   种类

## 按大小分区

-   小对象堆 SOH：所有小于8500字节的对象都在此处创建，压缩回收可以用于此处，因为不那么担心内存复制。32位的内存对齐方式为4字节，64位的内存对齐方式为8字节。
    
-   大对象堆 LOH：所有大于或等于8500字节堆对象，大对象堆复制成本较大，在LOH只使用一次清除回收。32/64位的对齐方式都是8字节，原因是double数组。
    

### double数组

double数组具有等于或者大于1000个元素的时候就回分配在LOH，由于double总是8字节长，所以对double的未对齐访问非常昂贵。所以LOH中不论是32还是64都是8字节对齐。那为什么不直接在LOH中分配double数组呢，因为LOH没有压缩，太多过小的结构引入回造成过多的内存碎片。

### 内部CLR数据

LargeHeapHandleTable

该结构管理在大对象堆中分配用于内部用途的对象数组。在内部，他被组织到Bucket中，每一个bucket表示在LOH中分配到单个Object[]数组。
