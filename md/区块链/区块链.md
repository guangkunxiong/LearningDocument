# 区块链，极客时间《说透区块链》和《区块链革命》

## 区块链的发展历程

### 《失控》和区块链

《失控》这本书的主题词基本可以概括为三句话九个字：分布式、去中心、自组织。这是他总结的独具特色的生物学进化论的中心逻辑框架。生物学进化论是相对于工业革命的机械学进化论而言的。大家都知道，工业革命的特色之一就是强调结构、标准和控制。而凯文·凯利的观点从书名《失控》就能一目了然：从控制到失控；从边缘到中心；从他治到自治。

在《失控》书中，凯文·凯利专门解释了分布式网络的特性：

- 没有强制性的中心控制；
- 次级单位具有自治的性质；
- 次级单位之间彼此高度连接；
- 点对点间的影响通过网络形成了非线性因果关系。

我们从中可以领会到的就是**弱控制、分中心、自治机制、网络架构和耦合连接等等与工业社会完全不同的信息社会时代的新型的社会结构、商业模式、人际关系。这其实就是区块链技术的全部精要**！区块链正是基于分布式系统集成多项成熟技术而成的。区块链的点对点价值传输、分布式数据库、分布式账本、智能合约和可编程数字货币就是凯文·凯利在《失控》一书中探讨的分布式网络在工程技术层面的具体实现。

作者认为区块链要对现实世界产生革命性影响，有几个问题必须澄清：

- 区块链的核心是分布式而不是去中心。分布式系统弱化了中心控制，而不是消灭了中心控制。区块链是弱中心化的、分中心化的。

- 区块链是分布式账本，但分布式账本不一定是区块链。

- 区块链在工程技术层面还不够成熟，离金融行业大面积应用还需要数年时间。

- 代码即法律”只是乌托邦理想，智能合约也只是帮助执行双方约定的计算机程序而已。智能合约既不是人工智能，也不是法律合同，只是帮助执行双方约定条件的一段计算机程序。

- 智能合约既不是人工智能，也不是法律合同，只是帮助执行双方约定条件的一段计算机程序。

### 区块链和金融科技

区块链（Blockchain）是一个由不同节点共同参与的分布式数据库系统，是开放式的账簿系统（ledger）；它是由一串按照密码学方法产生的数据块或数据包组成，即区块（block），对每一个区块数据信息都自动加盖时间戳，从而计算出一个数据加密数值，即哈希值（hash）。每一个区块都包含上一个区块的哈希值，从创始区块（genesis block）开始链接（chain）到当前区域，从而形成区块链。

**区块链技术的实质是在信息不对称的情况下，无需相互担保信任或第三方（所谓的“中心”）核发信用证书，采用基于互联网大数据的加密算法创设的节点普遍通过即为成立的节点信任机制。**任何机构和个人都可以作为节点参与创设信任机制，而且创设的区块必须在全网公示，任何节点参与人都看得见。节点越多，要求的算力就越强，只有超过51％的节点都通过，才能确立一个新区块成立，即获得认可；同时，要想篡改或造假，也需要掌控超过51％的节点，才可以修改。理论上，当区块链的节点达到足够数量时，这种大众广泛参与的信任创设机制，就可以无需“中心”授权即可形成信任、达成和约、确立交易、自动公示、共同监督。

#### 区块链将广泛用于金融领域

金融领域是区块链技术的重要应用领域。区块链技术将是互联网金融乃至整个金融业的关键底层基础设施（底层物质技术基础）。区块链技术可以低成本地解决金融活动的信任难题，并且将金融信任由双边互信或建立中央信任机制演化为多边共信、社会共信，以“共信力”寻求解决“公信力”问题的途径。由于区块链技术的加密算法特性，未来金融业会发展进入算法金融时代。

比特币是区块链技术应用的一个典型案例，虽然它不能当作法定货币，但是却为数字货币时代的到来和区块链技术广泛应用于解决金融、经济和社会问题，提供了底层技术基础。

### 萌芽

最近的一次世界级金融危机就在 2008 年，这次危机让很多先行者对现代金融体系逐渐失望。比特币的发明者中本聪敏锐地意识到，大部分的互联网贸易结算都依赖可信任的第三方金融机构处理，尽管在大多数时候这些系统的运转是足够好的。可是一旦遇上极端信任危机，信任关系的失衡就会导致现代金融体系的结构性塌陷。

常规的思路几乎失灵，但中本聪却另辟蹊径，提出了一种全新的解决方案，一个自由主义者拯救世界的故事就此拉开帷幕。这个方案最出彩的其实有两点，第一就是还原了支付原来的样子，第二就是创新性地引入了支付脚本。

什么是支付本来的样子呢？你可以这样理解，贸易支付的本质其实是买家与卖家的供需关系，只是由于买卖双方的不信任，才需要引入双方都信任的第三方进行担保，为双方的买卖行为背书。在中本聪看来，这种由信任作为媒介的运行模式是有问题的。所以，中本聪想到了去掉第三方担保的可能性，设计了一套基于密码学、无需买卖双方彼此信任就可以完成支付的数字货币系统。

在剔除信任纽带之外，比特币还创新性地引入支付脚本用于货币的支付。脚本实质是一段计算机程序代码，如果你可以输入正确的参数，脚本执行成功就意味着你拥有货币的使用权。所以我们可以认为，比特币通过程序脚本，实现了一个完全严格按照计算机逻辑运行的数字货币转移机制。但是，比特币的脚本功能并不完美，它只支持指令的顺序执行。而一般功能完善的计算机编程语言都支持顺序、分支以及循环。诚然，只基于顺序执行的脚本可以实现比特币的条件支付，但也仅限如此。

**因为比特币脚本没有分支判断能力，比特币仅将自身定位为加密货币，在复杂的契约逻辑面前是无能为力的。**

### 诞生期

有人注意到比特币的这种局限性，他就是以太坊的创始人，V 神。

在研究比特币的过程中，V 神逐渐认识到，比特币背后的区块链技术不光可以用在加密货币中，还有更多可能性，但比特币的架构却阻碍了技术的发展，因此他希望能够扩展比特币的脚本功能，使其更加智能。如果直接在比特币上打补丁，其扩展能力也极为有限。因此，V 神将他的精力集中到如何创建一个替代比特币的解决方案中，不久就发表了以太坊白皮书《以太坊：一个下一代加密货币和去中心化应用平台》。

在白皮书中，V 神阐述了以太坊构架愿景：在加密货币的基础上，增加智能合约功能，这样开发者就可通过智能合约编程把一切有价值的客观 / 主观事物锚定到以太坊进行交易，实现价值的传递。这也就是**区块链发展的最终形态是价值网络这个论调**的由来。

以太坊的核心我们可以认为就是智能合约的加持。而智能合约是软件工程师基于以太坊协议，自主编写的程序代码。不过我们都清楚，天底下几乎不存在没有 BUG 的软件系统，且以太坊智能合约是开源的，任何人都可以随时随地查看部署在以太坊上的智能合约源码，这就给黑客钻漏洞留下了空子。最著名的一次黑客攻击事件发生在 16 年 4 月，黑客将The DAO合约中锁定的价值约 1.5 亿美元的以太币偷走约 6000 万美元，并立刻在交易所抛售，给整个加密货币市场造成了不可挽回的损失。

16 年 7 月 20 日进行以太坊硬分叉，将以太坊主网分裂成两个网络，ETH 以及 ETC。ETH 删除了黑客攻击的一切痕迹，并将被盗走的以太币归还给原始拥有者，现在我们所说的以太坊指的就是回滚的这一分支。而 ETC 则保留了黑客攻击在内的全部交易，以保持区块链赖以生存的去中心化以及不可篡改的基本原则。正是因为这一事件，直接导致了后续区块链的野蛮生长。

### 野蛮生长期

所有的软件系统都会有 BUG。一般情况下，我们会在之前软件版本的基础上修改源码，新版本相比旧版本只有部分逻辑的不同，程序基本规则也没有太大的变化，两个版本的程序之间简单做些适配，就可以互相认知，可以说是无缝兼容的。我们把这种情况称之为迭代。而另一些时候，因为架构的调整、规则的变更，两个版本的程序之间已经无法兼容。这时我们就无法称之为迭代了，而是用重构指代这种变化。通常情况下，多次迭代叠加的结果就是重构，可以理解为量变引起质变。

而在区块链中，网络是由多个节点彼此相连组成的，节点间必须可以互相通信。几个小版本的软件迭代不影响区块链网络的运行，一些节点升级，而另一些节点继续使用原始版本，是不会引起区块链网络的割裂。**这种情况就是所谓的软分叉，其本质就是可兼容的程序版本更新。**

而一旦社区决定对区块链协议进行了重构，则必须协调整个网络节点都进行升级。你可以设想一下，如果一半节点继续使用原来的版本，而另一部分节点升级了新版本的程序，在这种情况下，一个区块链网络就被割裂成了两个。虽然他们的数据从属于共同的祖先，但是在某一时刻，他们独自派生出不同的数据走向。**这就是硬分叉的逻辑，其本质是不可兼容的程序版本更新。**

这就不难解释，为什么每一次区块链网络的升级都是一件大事，需要社区去协调从哪一个区块启用新版本，废弃老版本。

回到 The DAO 事件本身，以太坊通过硬分叉分裂成 ETH 跟 ETC，两个网络都保持独立运营。从逻辑上讲，并没有什么问题，是可以说得通的。

但坏就坏在其凭证是有价值的，在硬分叉前，我拥有 1 枚 ETH，而硬分叉以后，我既有 1 枚 ETH，同时我又拥有了 1 枚 ETC。相当于我在什么都没有操作的情况下，凭空多了一枚有价值的凭证，虽然其价值可能相较原始的 ETH 来说相对较低。

一些人的心思被解放了。如果我有理由述说比特币 / 以太坊存在的不足，提出解决方案，写一个白皮书，阐述我的观点及实现路径。我是不是也可以通过硬分叉的方式，创造属于我的区块链呢？同时，如果我能拉人站台，让他们为我拉票，是不是也会有更多的人认同我的观点？通过这样的操作，是不是也逐渐有人会为我的理想买单，而一旦有人为我买单，我就凭空创造了“财富”泡沫。一场轰轰烈烈的造链行动就开始了，各类基于硬分叉的旁系网络开枝散叶。最高兴也是最能推动这场行动的人，其实还并不是其创造者，而是在硬分叉前持有 BTC/ETH 的散户，他们得到了数不清的旁系凭证，当然希望其价值更高。所以他们就不断鼓动身边的人进场，进而不断推动这虚假的繁荣。

## 当前区块链发展

### 圈层的割裂

大家都认为区块链技术有更广阔的应用空间，但一部分人坚信比特币 / 以太坊是未来自由世界的流通货币，会成为数字黄金 / 白银，并很有可能挑战主权货币的垄断地位，因此他们继续在公链领域探索。

在此期间，陆续涌现了诸多技术应用创新，虽然每一个概念的提出都不免引起新一轮炒作。但总的来说，对于技术的探索一直在向前，这个圈子可称之为**公链圈**，其研究对象是有币的公有开放区块链网络，比如比特币 / 以太坊，这就跟应用开发者在苹果生态系统中开发应用一样。

而另一部分人意识到，只要比特币 / 以太币等数字货币存在一天，对其币价的市场操纵永远也不可能停歇，短时间内也看不到其与主权货币稳定汇率的可能性，国家政策也是呈现对有币区块链打压的趋势。与其这样，还不如跳出这个圈子，专注于区块链技术在企业领域的研究，而这个圈子我们称之为**联盟链圈**，其侧重点是研究如何根据企业自身业务定制联盟区块链，就好比现在各家手机厂商基于安卓开源系统做定制化的系统研发。

### 公链圈的创新

**公链圈的发展离不开投资激励，一切的技术应用创新都围绕着如何繁荣交易市场**。我们可以将公链圈的创新大致可以分为两类，一类是应用层面的，主要包括去中心化金融和去中心化存储；另一类是技术创新层面的，最突出的就是跨链，我们分别来看看。

#### 去中心化金融

去中心化金融，通常我们称之为 DeFi，是 Decentralised Finance 的缩写，这是公链圈最直接的发展驱动力。DeFi 就是运行在区块链网络上的金融服务。

参考资料：[Decentralized finance (DeFi) | ethereum.org](https://ethereum.org/en/defi/)

#### 去中心化存储

一种利用分布式存储技术，将文件分块存储在不同存储节点的应用型创新。相较于中心化存储，它拥有更高级别的隐私保护，存储成本也更低，且具备更冗余的数据备份副本，能有效避免单点故障。

其实去中心化存储跟区块链的关联并没有那么密切，区块链在其中的主要作用是作为存储层之上的一种激励计费机制。

去中心化存储的发展目前也面临着一些问题，主要有这样三方面。

- 对其币价的炒作几乎从未停止，真实有存储需求的用户几乎无法忍受因币价波动而导致的成本不确定性。

- 不同矿工贡献的空间是极度分散的，虽然在全世界各地都可以搭建，但受制于当地网络环境以及硬盘本身的机械素质，整个去中心化网络的存储性能不高，远不如中心化存储，因此只适合冷数据以及个人数据存储。

- 随着矿工的涌入，大部分项目的存储空间供应规模远远大于真正的需求，已经处于供大于求的局面，数据来源是当前急需解决的问题，怎样解决数据来源是当前重点，否则难有更大的发展。

参考资料：[What is Decentralized Storage? (IPFS, FileCoin, Sia, Storj & Swarm) | by Tom Terado | bitfwd | Medium](https://medium.com/bitfwd/what-is-decentralised-storage-ipfs-filecoin-sia-storj-swarm-5509e476995f)

#### 跨链

不同的区块链网络是独立的，是一个个的数据孤岛，跨链技术就是在这些岛之间构建互通的桥梁，提供不同链之间数据互通的可能性。

最初的跨链是两个链之间的直连，而现阶段的跨链更像是一个中枢，链与链之间的交互不再直接，而是通过中继链进行信息的中转，可以说，跨链技术的发展是其他创新的基础。

博卡波卡跨链协议的跨链网络示意图：

![](https://static001.geekbang.org/resource/image/be/c3/be8720b891fbc59faae9b5c490a661c3.jpg?wh=1819x1441)

没有创新，就没有投机的爆点，也就不可能有生态的繁荣。相较于前一阶段的野蛮生长，纯投机的项目逐渐消失，DeFi 是传统金融的衍生，而去中心化存储则是共享经济的一次探索，新概念的提出让它更贴近大众生活。

### 联盟链圈的发展

#### 数据存证

区块链技术具有时间连续，不可篡改，可回溯等特性，因此非常适合需要留存证据的数据存储。现阶段，像产品溯源、互联网法院、电子证照等应用都属于这一阶段的产物，大多数应用在区块链上存储的也只是数据证明，而非原始数据。

这种做法既与区块链本身的数据承载能力有关，也是业务本身的需求决定的。区块链中的数据从网络的维度来看，对存储及网络带宽的需求会随着数据量的增大呈指数级增长的趋势。

数据存证阶段的应用只是将数据存储在区块链上，只有在必要的时候才会利用其中的数据进行取证，绝大多数时候，数据是死的。区块链技术只是这些应用的一种特殊的技术保障，而不是非区块链技术不可。且大多数时候是各家玩各家的，并没有涉及到多方参与。在此阶段，区块链的可替代性较强。现在大多数企业区块链应用还停留在这一阶段。

#### 数据交换

传统的企业间合作都涉及到了商业数据的交换，一般情况下，数据交换的模式是数据提供方或需求方提供 API 接口的形式或拉或推的形式进行。而一旦涉及到数据的相互需求以及多于两家企业参与的情况，问题就变得更加棘手。

而通过区块链技术可以很方便地解决这个问题，在各家企业内部部署区块链节点，各家只需与自家运维的节点交互，区块链机制自动地将数据同步至其他参与方，任一节点如有新数据上链，区块链的事件通知机制自动通知各企业内部的应用。在此阶段，企业合作强依赖区块链作为数据交换的枢纽，因此区块链的替代性较低。且现在已有企业应用达到了数据交换的阶段，比如联邦学习与区块链技术的结合。

#### 价值转移

以太坊存在的意义之一，就是提供了一个将现实价值与数字世界锚定的媒介，也让我们看到了信息网络向价值网络转移的可能性。在企业区块链领域，这种意义可被无限放大，企业对外提供的产品无非是商品 / 服务 / 解决方案等。而如果通过区块链技术将企业产品转换成价值网络中的流通资产，在基础价值之外，亦可延伸出多种资产应用的可能性。

**而在这个阶段，区块链技术是价值网络的基石，无可替代**。当然，现阶段离价值网络还很远。

政策的出台激起了各行各业对区块链 + 的探索活动，各级政府也带头探索区块链技术在政务领域的内在价值。**政府等职能机构的主动参与是区块链在企业商业活动中能有广大发展前景的最大助推力，只有这样才能打破现在企业间商业合作模式的重重壁垒**。

**如果有一天，公链的每一个创新都能赋能实体经济，企业间能放下曾经构筑的层层商业壁垒，公链圈与联盟链圈重新相交相融，那就是区块链技术的黄金时代，价值网络触手可及**。

## 区块链的特点

### 去中心化

区块链存在的初衷就是去除中心化的第三方机构。当然，去中心化只是一个理想化的状态。现阶段来说区块链去中心化本质上是相对去中心化，我们也可以叫做多中心化。我们在理解概念的时候，不仅需要理性思维，更要学会使用感性思维去接受中间过程的渐变。

### 可追溯性

对单个节点来说，区块链可以被认为是一个**时序数据库**。每一次对系统的操作，实质是在每个节点数据库中存储了相应的数据及日志。且每一份数据都不是离散的存储，而是按时间顺序前后关联在一起，新的数据一定是从某一组之前已存在的数据派生而来。依照这种关联，如果想回溯数据的状态变更历史是很容易的，只需要依次往前查找，一定会找到数据的初始状态。而这一切都依赖于区块链存储技术，存储主要关注数据结构以及数据关系，包括交易以及区块的数据结构，交易与区块的关联关系，区块状态的存储模式等等。

### 不可篡改

**所谓篡改，就是私自的不被认可的修改，而不是不能修改**。

个区块链节点中的数据是按时间的先后顺序串联存储的，而串联的关键就利用了密码学中的哈希算法。哈希算法可以把一段数据变换成固定长度的数据指纹，而且只要数据有细微变化，得到的指纹也是大不一样的。通过这个方法，我们可以将前一时间段的数据指纹与后一时间段数据整合在一起。周而复始，后一时间段内的数据永远都会包含前一时间段的数据指纹，这样就形成了一条由数据指纹串联的信息链条。

如果有一个作恶者想要修改中间某一时间段的数据，那么依照哈希算法原理，其对应的数据指纹则会改变。因此他不得不依次修改后续的每一个时间段的数据，否则数据链条就会在他修改的这一刻断掉，不再具备可追溯性。

**如果从纯技术的角度讲，区块链是新一代信息技术的重要推动力，它利用了存储、密码学、点对点网络及共识算法等基础技术的融合，提供去中心化、可追溯以及不可篡改等特性，可以用来解决互联网中的信任及安全问题，从而推动互联网从信息传递向价值传递的变革。**

## 七大设计原则

### 网络化诚信

信任源自内在，而非外在。诚信被编码到流程的每一环节中，它是分布式的，而不依赖于任何一个成员。参与者之间能够直接进行价值交换并可以期望另一方以诚信的方式行事。也就是说，诚信价值观——包括言行上的诚实、考虑对方利益、对自己的决定与行为负责及决策与行动的公开透明等——会以编码形式体现在决定权、激励制度以及运作过程中，这样个人或机构就必需以诚信的方式行事，否则就可能会耗费更多的时间、金钱、能量和声誉。

中本聪利用现有分布式点对点网络及一些聪明的密码学技术创建了一套共识机计，这个值每十分钟就会出现一次。这就是个泊松分布过程，有时候只要一分钟，有时候要一小时，不过平均是十分钟一次。

矿工把网络中所有待处理交易收集起来，然后通过加密摘要函数来运行数据。这个加密摘要函数又叫安全哈希算法（SHA-256），一般输出32字节的哈希值。如果这个哈希值低于某特定目标（这个目标由网络设定且每隔2016个区块调整一次），那么就说明矿工已经找到了答案，并‘破解’了该区块。但不幸的是，对矿工而言，找到正确的哈希值非常困难。如果哈希值错误，那矿工就得稍微调整输入的数据，然后再次尝试。而每次尝试都会得出一个和之前截然不同的哈希值。他们不得不反复试验，直到找到正确答案为止。截止至2015年11月，哈希值尝试的次数平均达到3.5亿兆次。这个工作量非常大！

懒得抄了

### 分布式发电

系统通过一个点对点网络来分配电力，而不再进行单点控制。任何参与者都无法关闭系统。如果某个体或团体的电源被切断了，系统也还是能够运行。如果有超过一半的网络试图覆盖整个网络，那么每个人都可以看到事情的发生。

### 把价值作为激励

系统把所有利益相关者的奖励都结合到一起。比特币或者其他有价代币都是这个系统的一部分，也与声誉度是相关的。中本聪编写了这一软件，用来奖励那些参与其工作的人，而它是属于那些持有并使用其代币的人，这样他们都会认真维护这个软件。这有点像终极版本的电子宠物，区块链就是一个全球分布式的储备金。

### 安全性

网络中嵌入的安全措施是不会出现单点故障的，它们不光保证机密性，而且保证所有活动的真实性以及不可抵赖性。任何想要参与其中的人都必需使用加密技术（无法选择不使用），如果有人做出鲁莽的行为，那么其后果也只由当事人本人承担。

### 隐私

人们应当控制他们自己的数据。他们可以自主决定哪些身份信息、在什么时候、以何种方式、透露多少给其他人。尊重别人的隐私权和与尊重别人的意思是有区别的。

### 权利保护

所有权公开透明且可执行。个人自由是可以被承认和尊重的。我们坚持这一不证自明的真理——所有人具有与生俱来不可剥夺的权利，这些权利应该也能够受到保护。

## 区块链存储设计

### 交易

**从行为的角度解释，交易等同于操作（Operation）**，我们向区块链网络提交一笔交易实质上是发起了一个操作，而操作的具体内容与特定区块链协议有关，比如在以太坊中，一个操作可能就是执行了智能合约中的一个方法。

而如果我们从计算机技术的角度分析，**交易实质就是原子事物**，只是翻译的不一样，它们的英文都是 Transaction，交易是区块链网络中数据的最小的组成部分。一笔交易提交后，它只能有两种状态，要么成功要么失败，不可能存在成功了一半的情况。


